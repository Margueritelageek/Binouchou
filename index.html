<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pour toi Binouchou üíò</title>
  <meta name="description" content="Surprise de Saint‚ÄëValentin ‚ú® avec animation et mini escape game (v6.4.1)" />
  <style>
    :root{ --bg:#101018; --card:#181828; --accent:#ff4d6d; --accent2:#ffd6e0; --accent3:#6df3ff; --text:#f6f6f9; --muted:#b4b4c7; --success:#38d39f; --warning:#ffd166; --radius:18px; }
    *{box-sizing:border-box}
    body{ margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color:var(--text); background:
      radial-gradient(1200px 800px at 10% -10%, #1d1d2f 0%, transparent 60%),
      radial-gradient(1000px 600px at 110% 0%, #1a1a28 0%, transparent 60%), var(--bg); }
    a{ color:var(--accent)}
    .wrap{max-width:980px;margin:auto;padding:24px}
    header{ text-align:center; padding:56px 16px 24px; }
    h1{font-size:clamp(32px,5vw,48px); margin:0 0 8px}
    h2{font-size:clamp(22px,3.4vw,28px); margin:24px 0 12px}
    p.lead{color:var(--muted); margin:0 auto 12px; max-width:54ch}
    .card{ background:linear-gradient(180deg,rgba(255,255,255,0.06),rgba(255,255,255,0.03)); border:1px solid rgba(255,255,255,0.09); border-radius:var(--radius); padding:20px; box-shadow:0 10px 40px rgba(0,0,0,0.25); backdrop-filter: blur(6px); }
    .grid{display:grid; gap:16px}
    @media(min-width:840px){ .grid-2{grid-template-columns:1fr 1fr} }
    .btn{ display:inline-flex; align-items:center; gap:.5rem; cursor:pointer; border:0; color:#121217; background:linear-gradient(90deg,var(--accent),var(--accent3)); padding:12px 16px; border-radius:14px; font-weight:700; letter-spacing:.2px; box-shadow:0 10px 24px rgba(255,77,109,.35); transition:.2s; }
    .btn:hover{transform:translateY(-1px) scale(1.01)}
    .muted{color:var(--muted)}
    .typewriter{border-right:2px solid var(--accent); white-space:nowrap; overflow:hidden}
    .tag{display:inline-block;padding:2px 8px;border-radius:999px;background:rgba(255,77,109,.18);color:#ff4d6d;font-weight:700;font-size:12px;margin-left:6px}

    /* Hearts + üòõ burst (downward) */
    .burst-layer{ position:fixed; inset:0; pointer-events:none; overflow:hidden; z-index:9999; }
    .burst-item{ position:absolute; will-change:transform, opacity; font-size:24px; }
    @keyframes floatDown{ 0%{ transform: translate(var(--x,0), var(--y,0)) scale(0.9) rotate(0deg); opacity:0; } 10%{ opacity:1; } 100%{ transform: translate(var(--tx,0), var(--ty,120vh)) scale(1.05) rotate(var(--rot,20deg)); opacity:0; } }

    /* Escape game */
    .step{display:none}
    .step.active{display:block}
    .progress{height:8px; background:rgba(255,255,255,.08); border-radius:99px; overflow:hidden; margin:8px 0 6px}
    .bar{height:100%; width:0; background:linear-gradient(90deg,var(--accent),var(--accent3)); transition:.3s}
    .hint{font-size:13px; color:var(--muted)}

    /* Step1 grid */
    .puzzle-area{position:relative; border-radius:12px; border:1px solid rgba(255,255,255,.1); padding:14px; min-height:180px; display:grid; grid-template-columns:repeat(8,1fr); gap:6px; user-select:none}
    .puzzle-cell{display:flex; align-items:center; justify-content:center; height:38px; background:rgba(255,255,255,.04); border-radius:8px; border:1px solid rgba(255,255,255,.06); cursor:pointer}
    .puzzle-cell.reveal{background:rgba(255,77,109,.14); border-color:rgba(255,77,109,.35)}

    /* Starfield for SW */
    .space{position:relative; border-radius:12px; border:1px solid rgba(255,255,255,.1); padding:10px; display:grid; grid-template-columns:repeat(12, minmax(16px,1fr)); gap:6px; min-height:160px}
    .star{height:20px; border-radius:50%; background:radial-gradient(circle, rgba(255,255,255,.85) 0%, rgba(255,255,255,.4) 35%, rgba(255,255,255,.08) 70%); box-shadow:0 0 8px rgba(255,255,255,.25); cursor:pointer}
    .star.hit{background:radial-gradient(circle, #67d7ff 0%, #00aaff 40%, rgba(103,215,255,.2) 70%); box-shadow:0 0 12px rgba(0,170,255,.7)}

    /* Maze */
    .maze{display:grid; grid-template-columns:repeat(10,28px); grid-auto-rows:28px; gap:4px; padding:8px; border:1px solid rgba(255,255,255,.1); border-radius:12px; width:max-content; background:rgba(255,255,255,.03); touch-action:none}
    .cell{width:28px; height:28px; border-radius:6px; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.06)}
    .wall{background:rgba(255,255,255,.14)}
    .player{background:linear-gradient(180deg,#ffe3ea,#ff9caf); border-color:rgba(255,77,109,.45)}
    .goal{background:rgba(255,77,109,.18); position:relative}
    .goal::after{content:'‚ù§'; position:absolute; inset:0; display:flex; align-items:center; justify-content:center}
    .swipe-hint{font-size:12px; color:var(--muted); margin-top:6px}

    /* Simon musical */
    .pad-wrap{display:grid; grid-template-columns:repeat(2,120px); gap:12px; margin:10px 0}
    .pad{height:120px; border-radius:14px; border:2px solid rgba(255,255,255,.15); cursor:pointer; display:flex; align-items:center; justify-content:center; font-weight:800; letter-spacing:.5px}
    .pad[data-note="DO"]{background:rgba(255,255,255,.06)}
    .pad[data-note="RE"]{background:rgba(255,77,109,.10)}
    .pad[data-note="MI"]{background:rgba(109,243,255,.10)}
    .pad[data-note="FA"]{background:rgba(255,209,102,.10)}
    .pad.play{transform:scale(1.06); box-shadow:0 12px 26px rgba(0,0,0,.35); border-color:rgba(255,255,255,.4)}
    .controls{display:flex; gap:10px; align-items:center; margin-top:6px}
    .small{font-size:12px; color:var(--muted)}

    /* Photo slider */
    .slider{position:relative; aspect-ratio: 4/3; width:100%; border-radius:14px; overflow:hidden; border:1px solid rgba(255,255,255,.1); background:#0f0f17}
    .slide{position:absolute; inset:0; background-position:center; background-size:cover; opacity:0; transition:.6s opacity ease}
    .slide.active{opacity:1}
    .slider .nav{position:absolute; inset:auto 8px 8px 8px; display:flex; justify-content:space-between}
    .slider button.navbtn{background:rgba(0,0,0,.35); color:#fff; border:1px solid rgba(255,255,255,.25); border-radius:999px; padding:8px 10px; font-weight:700; cursor:pointer}
    .dots{position:absolute; bottom:8px; left:50%; transform:translateX(-50%); display:flex; gap:6px}
    .dot{width:8px; height:8px; border-radius:50%; background:rgba(255,255,255,.35)}
    .dot.active{background:#fff}
  </style>
</head>
<body>
  <div class="confetti" id="confetti" aria-hidden="true"></div>
  <div class="burst-layer" id="burst" aria-hidden="true"></div>

  <div class="wrap">
    <header>
      <h1>Pour toi <span id="name">Binouchou</span> <span class="tag"></span> üíò</h1>
      <p class="lead">Bienvenue dans <strong>l'ECAPE GAME du LOVE</strong>üíò</p>
      <button class="btn" id="startBtn">Active la Love Bomb</button>
    </header>

    <section class="grid grid-2">
      <div class="card">
        <h2>Active la bande‚Äëson</h2>
        <p class="muted"></p>
        <iframe title="Deezer" src="https://widget.deezer.com/widget/dark/album/727556231?autoplay=true" width="100%" height="180" frameborder="0" allowtransparency="true" allow="encrypted-media; clipboard-write"></iframe>
      </div>
      <div class="card">
        <h2>Photos de nous üíë</h2>
        <p class="muted" style="margin-top:-6px"></code></p>
        <div class="slider" id="slider">
          <!-- slides injected by JS from CONFIG.photos -->
          <div class="nav"><button class="navbtn" id="prev">‚óÄ</button><button class="navbtn" id="next">‚ñ∂</button></div>
          <div class="dots" id="dots"></div>
        </div>
      </div>
    </section>

    <section id="escape" class="card" style="margin-top:16px">
      <div class="progress"><div class="bar" id="bar" style="width:0%"></div></div>
      <h2>Mini‚ÄëEscape Game du Love</h2>
      <p class="muted">Six petites √©preuves pour d√©bloquer ta surprise finale üíù</p>

      <div id="step1" class="step active">
        <h3>√âpreuve 1/6 ‚Äî C≈ìur cach√© üïµÔ∏è‚Äç‚ôÄÔ∏è: pas si vite loustic, tu n'as que 8 essais !</h3>
        <p class="hint">Clique sur les cases pour le d√©nicher. Indices ¬´¬†Chaud/Froid¬†¬ª. <strong>8 essais</strong> max.</p>
        <div class="puzzle-area" id="grid"></div>
        <p id="res1" class="muted"></p>
      </div>

      <div id="step2" class="step">
        <h3>√âpreuve 2/6 ‚Äî Notre premier bisou üòò</h3>
        <p class="hint">Entre la date (ex: 17/11/2024). <span class="muted">(format souple)</span></p>
        <div class="center"><input id="dateInput" type="text" placeholder="jj/mm/aaaa" inputmode="numeric" />
          <button class="btn" id="checkDate">Valider</button></div>
        <p id="res2" class="muted"></p>
      </div>

      <div id="step3" class="step">
        <h3>√âpreuve 3/6 ‚Äî Desperate Housewives üì∫</h3>
        <p class="hint">Dans quelle saison a lieu l‚Äô√©pisode de la <strong>tornade</strong> qui frappe Wisteria Lane ?</p>
        <div class="radio">
          <label><input type="radio" name="qdh" value="A"> Saison 3</label>
          <label><input type="radio" name="qdh" value="B"> Saison 4</label>
          <label><input type="radio" name="qdh" value="C"> Saison 5</label>
        </div>
        <button class="btn" id="checkDH">Valider</button>
        <p id="res3" class="muted"></p>
      </div>

      <div id="step4" class="step">
        <h3>√âpreuve 4/6 ‚Äî Star Wars ‚ú® Trouve le sabre laser</h3>
        <p class="hint">La Force t'accompagne‚Ä¶ Clique dans le <strong>ciel √©toil√©</strong>. Indices <em>Hyperfroid ‚Üí Froid ‚Üí Ti√®de ‚Üí Chaud ‚Üí Tr√®s chaud</em>. 10 essais max.</p>
        <div class="space" id="space"></div>
        <p id="res4" class="muted"></p>
      </div>

      <div id="step5" class="step">
        <h3>√âpreuve 5/6 ‚Äî La M√©lodie du Bonheur üé∂ (Simon musical)</h3>
        <p class="hint">R√©p√®te la suite affich√©e par les boutons. Le niveau augmente √† chaque r√©ussite. Objectif : <strong>7</strong> !</p>
        <div class="pad-wrap">
          <div class="pad" data-note="DO">DO</div>
          <div class="pad" data-note="RE">RE</div>
          <div class="pad" data-note="MI">MI</div>
          <div class="pad" data-note="FA">FA</div>
        </div>
        <div class="controls">
          <button class="btn" id="playSeq">‚ñ∂Ô∏è Lancer / Rejouer</button>
          <span class="small">Astuce : chante en m√™me temps, √ßa aideüí°</span>
        </div>
        <p id="res5" class="muted"></p>
      </div>

      <div id="step6" class="step">
        <h3>√âpreuve 6/6 ‚Äî Mini labyrinthe üíû</h3>
        <p class="hint">Atteins le c≈ìur. Clavier (‚¨ÜÔ∏è‚¨áÔ∏è‚¨ÖÔ∏è‚û°Ô∏è) sur ordi, <strong>swipe</strong> sur mobile üì±</p>
        <div class="maze" id="maze"></div>
        <p id="res6" class="muted swipe-hint">Astuce mobile : glisse ton doigt dans la direction voulue.</p>
      </div>

      <div id="stepFinal" class="step">
        <h3>Bravo Binouchou ! üéâ</h3>
        <p class="ok">Tu as d√©bloqu√© la surprise :</p>
        <p id="reveal" style="font-weight:700; font-size:18px">üéÅ Tout √ßa pour dire que tu es le meilleur üíò Et pour f√™ter √ßa, on va au resto vendredi ! Tenue d√©contract√©e, sourire obligatoire ‚ú®</p>
        <button class="btn" onclick="window.scrollTo({top:0, behavior:'smooth'})">Remonter en haut</button>
      </div>
    </section>
  </div>

  <script>
    const CONFIG = {
      partnerName:'Binouchou', fromName:'Marguerite', revealAt:'2026-02-14T19:30:00',
      escape:{ expectedDate:'17/11/2024', maxTries:8, correctSeason:'B' },
      simonTarget:7,
      photos:[
        'IMG-20250130-WA0000.jpg','IMG-20250914-WA0004.jpg','IMG-20250914-WA0006.jpg','IMG_20241211_213627.jpg','IMG_20241215_223530.jpg','IMG_20250309_100513.jpg','IMG_20250309_160654.jpg','IMG_20250724_160135_2.jpg','IMG_20251018_175608.jpg','voila_1744232995005.jpg'
      ],
      slider:{ autoplay:true, delay:3000 }
    };

    function typewriter(el, speed=22){ const full=el?.textContent?.trim?.()||''; if(!el||!full){return;} el.textContent=''; el.classList.add('typewriter'); let i=0; const t=setInterval(()=>{ el.textContent += full[i++]||''; if(i>=full.length){ el.classList.remove('typewriter'); clearInterval(t); } }, speed); }

    function burstHearts(duration=7000, count=140){ const layer=document.getElementById('burst'); const W=innerWidth, H=innerHeight; const emojis=['‚ù§Ô∏è','üíñ','üíï','üíò','üíó','üíì','üíû','üòõ','üòú']; for(let i=0;i<count;i++){ const el=document.createElement('div'); el.className='burst-item'; el.textContent=emojis[Math.floor(Math.random()*emojis.length)]; const startX=Math.random()*W, startY=-(Math.random()*160+40); const driftX=(Math.random()*2-1)*160; const endY=H+Math.random()*200; const rot=(Math.random()*360-180)+'deg', size=18+Math.random()*26; el.style.left=startX+'px'; el.style.top=startY+'px'; el.style.fontSize=size+'px'; el.style.setProperty('--tx',driftX+'px'); el.style.setProperty('--ty',endY+'px'); el.style.setProperty('--rot',rot); const dur=5000+Math.random()*3500; el.style.animation='floatDown '+dur+'ms ease-in forwards'; el.style.filter='drop-shadow(0 3px 8px rgba(0,0,0,.25))'; layer.appendChild(el); setTimeout(()=>el.remove(), dur+800);} setTimeout(()=>{ Array.from(layer.children).forEach(n=>n.remove()); }, duration+5000); }

    function launchConfetti(duration=2200){ const c=document.getElementById('confetti'); const end=Date.now()+duration; const spawn=()=>{ for(let i=0;i<8;i++){ const h=document.createElement('div'); h.className='heart'; h.style.left=Math.random()*100+'vw'; h.style.animationDuration=(3+Math.random()*2)+'s'; h.style.background=Math.random()>0.5?'var(--accent)':'var(--accent2)'; h.style.filter='drop-shadow(0 2px 6px rgba(0,0,0,.2))'; c.appendChild(h); setTimeout(()=>h.remove(),5000);} if(Date.now()<end) requestAnimationFrame(spawn); }; spawn(); }

    function normalizeDate(s){ return (s||'').toString().toLowerCase().replace(/[^0-9]/g,''); }

    const stepIds=['step1','step2','step3','step4','step5','step6','stepFinal']; let current=0; function setStep(i){ stepIds.forEach((id,idx)=>document.getElementById(id).classList.toggle('active', idx===i)); current=i; const total=stepIds.length-1; document.getElementById('bar').style.width=Math.min(100, Math.round(i*100/total))+'%'; } function next(){ setStep(Math.min(current+1, stepIds.length-1)); }

    // Step1 grid
    function buildGrid(){ const grid=document.getElementById('grid'); grid.innerHTML=''; const cols=8, total=48; const target=Math.floor(Math.random()*total); const ty=Math.floor(target/cols), tx=target%cols; let tries=0; const maxT=CONFIG.escape.maxTries; for(let i=0;i<total;i++){ const cell=document.createElement('div'); cell.className='puzzle-cell'; cell.textContent='¬∑'; cell.dataset.idx=i; grid.appendChild(cell); cell.addEventListener('click',()=>{ if(current!==0) return; tries++; const idx=+cell.dataset.idx; const y=Math.floor(idx/cols), x=idx%cols; const dist=Math.abs(x-tx)+Math.abs(y-ty); if(idx===target){ cell.classList.add('reveal'); cell.textContent='‚ù§'; document.getElementById('res1').innerHTML=`<span class="ok">Trouv√© en ${tries} essai(s) !</span>`; next(); } else { if(tries>=maxT){ document.getElementById('res1').innerHTML=`<span class="warn">Oups, ${maxT} essais √©coul√©s. Nouvelle grille !</span>`; buildGrid(); } else { const hint=dist<=1?'üî• Br√ªlant':dist<=2?'‚ô®Ô∏è Chaud':dist<=4?'üå§Ô∏è Ti√®de':'‚ùÑÔ∏è Froid'; document.getElementById('res1').innerHTML=`${hint} ‚Äî essai ${tries}/${maxT}`; cell.style.opacity=0.6; } } }); } }

    // Step2 date
    function onCheckDate(){ const got=normalizeDate(document.getElementById('dateInput').value); const want=normalizeDate(CONFIG.escape.expectedDate); const res=document.getElementById('res2'); if(!got){ res.textContent='Indique une date üòä'; return; } if(got===want){ res.innerHTML='<span class="ok">Parfait !</span>'; next(); } else { res.innerHTML='<span class="warn">Choqu√©e ! est-ce que tu m√©rites vraiment la surprise..</span>'; } }

    // Step3 DH
    function onCheckDH(){ const picked=document.querySelector('input[name="qdh"]:checked'); const res=document.getElementById('res3'); if(!picked){ res.textContent='Choisis une saison üòá'; return; } if(picked.value===CONFIG.escape.correctSeason){ res.innerHTML='<span class="ok">Exact : saison 4 !</span>'; launchConfetti(); next(); } else { res.innerHTML='<span class="warn">Bah alors.. il va falloir tout re-regarder !/span>'; } }

    // Step4 Star Wars
    function initStarWars(){ const space=document.getElementById('space'); space.innerHTML=''; const cols=12, rows=8, total=cols*rows, target=Math.floor(Math.random()*total); let tries=0, maxT=10; const ty=Math.floor(target/cols), tx=target%cols; for(let i=0;i<total;i++){ const d=document.createElement('div'); d.className='star'; d.dataset.idx=i; space.appendChild(d); d.addEventListener('click',()=>{ if(current!==3) return; tries++; const idx=+d.dataset.idx; const y=Math.floor(idx/cols), x=idx%cols; const man=Math.abs(x-tx)+Math.abs(y-ty); if(idx===target){ d.classList.add('hit'); document.getElementById('res4').innerHTML='<span class="ok">Tu as trouv√© le sabre !</span>'; next(); } else { if(tries>=maxT){ document.getElementById('res4').innerHTML='<span class="warn">La Force s‚Äô√©puise‚Ä¶ nouvelle galaxie !</span>'; initStarWars(); } else { const hint=man<=1?'üî• Tr√®s chaud':man<=2?'‚ú® Chaud':man<=4?'üå§Ô∏è Ti√®de':man<=6?'üíß Froid':'üßä Hyperfroid'; document.getElementById('res4').innerHTML=`${hint} ‚Äî essai ${tries}/${maxT}`; d.style.opacity=0.5; } } }); } }

    // Step5 Simon musical
    function initSimon(){ const pads=Array.from(document.querySelectorAll('#step5 .pad')); const res=document.getElementById('res5'); const playBtn=document.getElementById('playSeq'); const notes=['DO','RE','MI','FA']; let seq=[], inputPos=0, playing=false, accepting=false, target=CONFIG.simonTarget||7; function flashPad(pad, dur=420){ return new Promise(ok=>{ pad.classList.add('play'); setTimeout(()=>{ pad.classList.remove('play'); setTimeout(ok, 120); }, dur); }); } async function playSequence(){ accepting=false; playing=true; res.textContent=`Niveau ${seq.length+1}‚Ä¶`; for(const n of seq){ const pad=pads.find(p=>p.dataset.note===n); await flashPad(pad); } playing=false; accepting=true; inputPos=0; res.textContent=`√Ä toi ! (${seq.length} notes)`; } function nextRound(){ seq.push(notes[Math.floor(Math.random()*notes.length)]); playSequence(); } function reset(){ seq=[]; inputPos=0; accepting=false; playing=false; } pads.forEach(p=>{ p.addEventListener('click', async ()=>{ if(!accepting||playing) return; const n=p.dataset.note; await flashPad(p,200); if(n===seq[inputPos]){ inputPos++; if(inputPos===seq.length){ if(seq.length>=target){ res.innerHTML='<span class="ok">Magnifique !</span>'; next(); } else { setTimeout(nextRound,600); } } } else { res.innerHTML='<span class="warn">Oups ! On rejoue la s√©quence‚Ä¶</span>'; setTimeout(playSequence,500); } }); }); playBtn.addEventListener('click', ()=>{ reset(); nextRound(); }); }

    // Step6 Maze (simplified, solvable)
    function initMaze(){
      const mazeEl=document.getElementById('maze'); mazeEl.innerHTML='';
      const W=10, H=7;
      // Medium difficulty: fewer walls, clear path
      const wallCoords=[
        '2,0','6,0',
        '1,1','5,1','7,1',
        '1,2','4,2','7,2',
        '1,3','3,3','5,3',
        '2,4','6,4',
        '2,5','6,5','8,5'
      ];
      const walls=new Set(wallCoords);
      let px=0, py=0; const gx=9, gy=6;

      function draw(){ mazeEl.innerHTML=''; for(let y=0;y<H;y++){ for(let x=0;x<W;x++){ const c=document.createElement('div'); c.className='cell'; if(walls.has(x+','+y)) c.classList.add('wall'); if(x===px&&y===py) c.classList.add('player'); if(x===gx&&y===gy) c.classList.add('goal'); mazeEl.appendChild(c); } } }
      function tryMove(dx,dy){ const nx=px+dx, ny=py+dy; if(nx<0||nx>=W||ny<0||ny>=H) return; if(walls.has(nx+','+ny)) return; px=nx; py=ny; draw(); if(px===gx&&py===gy){ document.getElementById('res6').innerHTML='<span class="ok">Bravo !</span>'; launchConfetti(); next(); detach(); } }
      function onKey(e){ const k=e.key; if(k==='ArrowRight') tryMove(1,0); else if(k==='ArrowLeft') tryMove(-1,0); else if(k==='ArrowDown') tryMove(0,1); else if(k==='ArrowUp') tryMove(0,-1); }

      // Swipe controls
      let tX=null, tY=null, t0=0; const TH=20, MAXDT=700;
      function onTouchStart(e){ const t=e.changedTouches[0]; tX=t.clientX; tY=t.clientY; t0=Date.now(); }
      function onTouchEnd(e){ const t=e.changedTouches[0]; const dx=t.clientX-tX; const dy=t.clientY-tY; const dt=Date.now()-t0; if(dt>MAXDT) return; if(Math.max(Math.abs(dx),Math.abs(dy))<TH) return; if(Math.abs(dx)>Math.abs(dy)) { tryMove(dx>0?1:-1,0); } else { tryMove(0, dy>0?1:-1); } }

      function attach(){ window.addEventListener('keydown', onKey); mazeEl.addEventListener('touchstart', onTouchStart, {passive:true}); mazeEl.addEventListener('touchend', onTouchEnd, {passive:true}); }
      function detach(){ window.removeEventListener('keydown', onKey); mazeEl.removeEventListener('touchstart', onTouchStart); mazeEl.removeEventListener('touchend', onTouchEnd); }

      attach(); draw();
    }

    // === Photo slider ===
    function initSlider(){
      const el=document.getElementById('slider'); const dots=document.getElementById('dots'); const prev=document.getElementById('prev'); const next=document.getElementById('next');
      const urls=(CONFIG.photos||[]).slice();
      if(urls.length===0){ el.innerHTML='<p class="muted" style="padding:12px">Ajoute tes URLs dans <code>CONFIG.photos</code> ‚ú®</p>'; return; }
      const slides=[]; urls.forEach((u,i)=>{ const s=document.createElement('div'); s.className='slide'+(i===0?' active':''); s.style.backgroundImage=`url(${u})`; el.appendChild(s); slides.push(s); });
      let idx=0; function go(i){ slides[idx].classList.remove('active'); dots.children[idx]?.classList.remove('active'); idx=(i+slides.length)%slides.length; slides[idx].classList.add('active'); dots.children[idx]?.classList.add('active'); }
      // dots
      urls.forEach((_,i)=>{ const d=document.createElement('div'); d.className='dot'+(i===0?' active':''); d.addEventListener('click',()=>go(i)); dots.appendChild(d); });
      prev.addEventListener('click', ()=>go(idx-1)); next.addEventListener('click', ()=>go(idx+1));
      // swipe
      let sx=0, sy=0; el.addEventListener('touchstart', e=>{ sx=e.touches[0].clientX; sy=e.touches[0].clientY; }, {passive:true});
      el.addEventListener('touchend', e=>{ const dx=e.changedTouches[0].clientX-sx; const dy=e.changedTouches[0].clientY-sy; if(Math.abs(dx)>Math.abs(dy) && Math.abs(dx)>24){ if(dx<0) go(idx+1); else go(idx-1); } }, {passive:true});
      // autoplay
      if(CONFIG.slider?.autoplay){ setInterval(()=>go(idx+1), CONFIG.slider.delay||3000); }
    }

    (function init(){
      document.getElementById('name').textContent=CONFIG.partnerName;
      document.getElementById('startBtn').addEventListener('click', ()=>{ typewriter(document.getElementById('letter')); burstHearts(); document.getElementById('escape').scrollIntoView({behavior:'smooth'}); });
      initSlider();
      buildGrid();
      document.getElementById('checkDate').addEventListener('click', onCheckDate);
      document.getElementById('checkDH').addEventListener('click', onCheckDH);
      initStarWars();
      initSimon();
      initMaze();
    })();
  </script>
</body>
</html>
